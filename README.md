# 🧠 LLM-Powered CSV Editor

A smart web application that allows you to edit CSV files using natural language commands. Simply upload your CSV and tell the app what you want to do in plain English - the AI will generate and execute the appropriate Python code for you.

## ✨ Features

- **Natural Language Interface**: Edit CSVs using plain English commands
- **Real-time Code Generation**: See the Python/Pandas code generated by AI
- **Instant Execution**: Changes are applied immediately to your data
- **Visual Feedback**: View original and modified data side-by-side
- **Download Results**: Export your modified CSV file
- **Error Handling**: Comprehensive error messages and debugging support

## 🛠️ Technology Stack

- **Frontend**: Streamlit
- **Data Processing**: Pandas
- **AI**: Azure OpenAI
- **Integration**: LangChain
- **Language**: Python

## 📋 Prerequisites

- Python 3.8+
- Azure OpenAI API access
- Required Python packages (see requirements.txt)

## 🚀 Installation

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd llm-csv-editor
   ```

2. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

3. **Set up environment variables**
   
   Create a `.env` file in the project root:
   ```env
   AZURE_DEPLOYMENT_NAME=your_deployment_name
   AZURE_API_KEY=your_api_key
   AZURE_ENDPOINT=your_azure_endpoint
   AZURE_API_VERSION=2023-05-15
   AZURE_MODEL_NAME=gpt-35-turbo
   ```

## 📦 Requirements

Create a `requirements.txt` file:
```txt
streamlit
pandas
python-dotenv
langchain-openai
langchain-core
```

## 🎯 Usage

1. **Start the application**
   ```bash
   streamlit run app.py
   ```

2. **Upload your CSV file** using the file uploader

3. **Enter natural language commands** such as:
   - "Add a column called 'Total' with all values as 100"
   - "Delete rows where Age is less than 18"
   - "Change all 'Male' values to 'M' in the Gender column"
   - "Sort the data by Name in ascending order"
   - "Fill missing values in the Salary column with 50000"

4. **View the generated code** and results

5. **Download the modified CSV** file

## 💡 Example Commands

| Command | Description |
|---------|-------------|
| `Add a new column 'Status' with value 'Active'` | Creates a new column |
| `Remove rows where Age > 65` | Filters data |
| `Replace all NaN values with 0` | Handles missing data |
| `Group by Department and sum Salary` | Aggregates data |
| `Sort by Date in descending order` | Sorts data |

## 🔧 Configuration

### Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `AZURE_DEPLOYMENT_NAME` | Your Azure OpenAI deployment name | Yes |
| `AZURE_API_KEY` | Your Azure OpenAI API key | Yes |
| `AZURE_ENDPOINT` | Your Azure OpenAI endpoint URL | Yes |
| `AZURE_API_VERSION` | API version (default: 2023-05-15) | No |
| `AZURE_MODEL_NAME` | Model name (default: gpt-35-turbo) | No |

## 🛡️ Security Notes

- Keep your `.env` file secure and never commit it to version control
- The application executes generated Python code - use in trusted environments
- Consider implementing additional security measures for production use

## 🚨 Error Handling

The application includes comprehensive error handling for:
- Missing environment variables
- Invalid CSV files
- Code generation failures
- Code execution errors
- Network connectivity issues

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## 📝 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🙏 Acknowledgments

- OpenAI for providing the language model capabilities
- Streamlit for the intuitive web framework
- Pandas for powerful data manipulation tools
- LangChain for seamless AI integration

## 📞 Support

If you encounter any issues or have questions:
- Open an issue on GitHub
- Check the troubleshooting section below

## 🔍 Troubleshooting

### Common Issues

**Environment Variables Not Found**
- Ensure your `.env` file is in the project root directory
- Check that all required variables are set correctly

**Azure OpenAI Connection Error**
- Verify your API key and endpoint
- Check your Azure subscription status
- Ensure the deployment name matches your Azure setup

**Code Execution Errors**
- Review the generated code for syntax issues
- Try simpler commands first
- Check if your CSV data format is compatible

## 🔮 Future Enhancements

- [ ] Support for Excel files (.xlsx, .xls)
- [ ] Data visualization capabilities
- [ ] Command history and favorites
- [ ] Batch processing multiple files
- [ ] Advanced data validation
- [ ] Export to multiple formats (JSON, Parquet)

---

Made with ❤️ using Python, Streamlit, and Azure OpenAI
